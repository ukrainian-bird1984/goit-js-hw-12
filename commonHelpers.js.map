{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport Axios from 'axios';\n\nconst axios = Axios.create({\n  baseURL: 'https://pixabay.com',\n  params: {\n    key: '42310325-d8e2b88bd4f4d7db9639050a5',\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: 15,\n    page: 1,\n  },\n});\nlet galleryLightbox = new SimpleLightbox('.image-link', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst form = document.querySelector('.form');\nconst searchInput = document.querySelector('.input-name');\nconst loader = document.querySelector('.loader');\nconst gallery = document.querySelector('.gallery');\nconst loadBtn = document.querySelector('.load-btn');\nlet page = 1;\nlet currentSearchQuery = '';\nlet totalHits = 0;\n\nform.addEventListener('submit', getPhoto);\n\nasync function getPhoto(event) {\n  event.preventDefault();\n\n  const searchQuery = searchInput.value.trim();\n\n  if (searchQuery === '') {\n    showError('Please enter a search query');\n    return;\n  }\n\n  if (searchQuery !== currentSearchQuery) {\n    page = 1;\n    currentSearchQuery = searchQuery;\n  }\n\n  loader.classList.add('visible');\n\n  try {\n    const response = await axios.get('/api/', {\n      params: { q: searchQuery, page },\n    });\n\n    const data = response.data;\n    totalHits = data.totalHits;\n    renderPhotos(data.hits);\n  } catch (error) {\n    showError('Error fetching data');\n    console.log('Error fetching data:', error);\n  } finally {\n    loader.classList.remove('visible');\n  }\n}\n\nloadBtn.addEventListener('click', onLoadMoreClick);\n\nasync function onLoadMoreClick() {\n  const searchQuery = searchInput.value.trim();\n\n  loader.classList.add('visible');\n\n  try {\n    const response = await axios.get('/api/', {\n      params: { q: searchQuery, page: page + 1 },\n    });\n    const data = response.data;\n    renderPhotos(data.hits);\n    page += 1;\n  } catch (error) {\n    showError('Error fetching more data');\n    console.log('Error fetching more data:', error);\n  } finally {\n    loader.classList.remove('visible');\n  }\n}\n\nfunction showError(message) {\n  iziToast.show({\n    title: 'Error',\n    message,\n    position: 'center', \n  });\n}\n\nfunction makeMarkup(\n  webformatURL,\n  largeImageURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads\n) {\n  return `<li class=\"photo\">\n    <div class=\"photo-card\">\n      <a class=\"image-link\" data-lightbox=\"image\" href=\"${largeImageURL}\">\n        <img class=\"gallery-image\" data-source=\"${largeImageURL}\" src=\"${webformatURL}\" alt=\"${tags}\"></img>\n      </a>\n    </div>\n    <div class=\"description\">\n      <p class=\"description-item\"> Likes ${likes}</p>\n      <p class=\"description-item\"> Views ${views}</p>\n      <p class=\"description-item\"> Comments ${comments}</p>\n      <p class=\"description-item\"> Downloads ${downloads}</p>\n    </div>\n  </li>`;\n}\n\nfunction renderPhotos(photos) {\n  gallery.innerHTML = ''; \n\n  if (photos.length === 0) {\n    showError('Sorry, there are no images matching your search query. Please try again!');\n  }\n\n  photos.forEach(photo => {\n    const {\n      webformatURL,\n      largeImageURL,\n      tags,\n      likes,\n      views,\n      comments,\n      downloads,\n    } = photo;\n    const photoElement = makeMarkup(\n      webformatURL,\n      largeImageURL,\n      tags,\n      likes,\n      views,\n      comments,\n      downloads\n    );\n    gallery.insertAdjacentHTML('beforeend', photoElement);\n  });\n\n  galleryLightbox.refresh();\n  showLoadBtn();\n}\n\nfunction showLoadBtn() {\n  if (page * 15 < totalHits && page <= Math.ceil(totalHits / 15)) {\n    loadBtn.style.visibility = 'visible';\n  } else {\n    loadBtn.style.visibility = 'hidden';\n    showError('Cannot visualize more images');\n  }\n}\n\n\nsearchInput.addEventListener('input', clearError);\n\nfunction clearError() {\n  const errorMessage = document.querySelector('.iziToast');\n  if (errorMessage) {\n    errorMessage.remove();\n  }\n}\n\nform.addEventListener('submit', () => {\n  clearError();\n  searchInput.value = searchInput.value.trim(); \n});\n"],"names":["axios","Axios","galleryLightbox","SimpleLightbox","form","searchInput","loader","gallery","loadBtn","page","currentSearchQuery","totalHits","getPhoto","event","searchQuery","showError","data","renderPhotos","error","onLoadMoreClick","message","iziToast","makeMarkup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","photos","photo","photoElement","showLoadBtn","clearError","errorMessage"],"mappings":"owBAMA,MAAMA,EAAQC,EAAM,OAAO,CACzB,QAAS,sBACT,OAAQ,CACN,IAAK,qCACL,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,GACV,KAAM,CACP,CACH,CAAC,EACD,IAAIC,EAAkB,IAAIC,EAAe,cAAe,CACtD,aAAc,MACd,aAAc,GAChB,CAAC,EAED,MAAMC,EAAO,SAAS,cAAc,OAAO,EACrCC,EAAc,SAAS,cAAc,aAAa,EAClDC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAU,SAAS,cAAc,WAAW,EAClD,IAAIC,EAAO,EACPC,EAAqB,GACrBC,EAAY,EAEhBP,EAAK,iBAAiB,SAAUQ,CAAQ,EAExC,eAAeA,EAASC,EAAO,CAC7BA,EAAM,eAAc,EAEpB,MAAMC,EAAcT,EAAY,MAAM,KAAI,EAE1C,GAAIS,IAAgB,GAAI,CACtBC,EAAU,6BAA6B,EACvC,MACD,CAEGD,IAAgBJ,IAClBD,EAAO,EACPC,EAAqBI,GAGvBR,EAAO,UAAU,IAAI,SAAS,EAE9B,GAAI,CAKF,MAAMU,GAJW,MAAMhB,EAAM,IAAI,QAAS,CACxC,OAAQ,CAAE,EAAGc,EAAa,KAAAL,CAAM,CACtC,CAAK,GAEqB,KACtBE,EAAYK,EAAK,UACjBC,EAAaD,EAAK,IAAI,CACvB,OAAQE,EAAO,CACdH,EAAU,qBAAqB,EAC/B,QAAQ,IAAI,uBAAwBG,CAAK,CAC7C,QAAY,CACRZ,EAAO,UAAU,OAAO,SAAS,CAClC,CACH,CAEAE,EAAQ,iBAAiB,QAASW,CAAe,EAEjD,eAAeA,GAAkB,CAC/B,MAAML,EAAcT,EAAY,MAAM,KAAI,EAE1CC,EAAO,UAAU,IAAI,SAAS,EAE9B,GAAI,CAIF,MAAMU,GAHW,MAAMhB,EAAM,IAAI,QAAS,CACxC,OAAQ,CAAE,EAAGc,EAAa,KAAML,EAAO,CAAG,CAChD,CAAK,GACqB,KACtBQ,EAAaD,EAAK,IAAI,EACtBP,GAAQ,CACT,OAAQS,EAAO,CACdH,EAAU,0BAA0B,EACpC,QAAQ,IAAI,4BAA6BG,CAAK,CAClD,QAAY,CACRZ,EAAO,UAAU,OAAO,SAAS,CAClC,CACH,CAEA,SAASS,EAAUK,EAAS,CAC1BC,EAAS,KAAK,CACZ,MAAO,QACP,QAAAD,EACA,SAAU,QACd,CAAG,CACH,CAEA,SAASE,EACPC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACA,CACA,MAAO;AAAA;AAAA,0DAEiDL,CAAa;AAAA,kDACrBA,CAAa,UAAUD,CAAY,UAAUE,CAAI;AAAA;AAAA;AAAA;AAAA,2CAIxDC,CAAK;AAAA,2CACLC,CAAK;AAAA,8CACFC,CAAQ;AAAA,+CACPC,CAAS;AAAA;AAAA,QAGxD,CAEA,SAASZ,EAAaa,EAAQ,CAC5BvB,EAAQ,UAAY,GAEhBuB,EAAO,SAAW,GACpBf,EAAU,0EAA0E,EAGtFe,EAAO,QAAQC,GAAS,CACtB,KAAM,CACJ,aAAAR,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACD,EAAGE,EACEC,EAAeV,EACnBC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,CACN,EACItB,EAAQ,mBAAmB,YAAayB,CAAY,CACxD,CAAG,EAED9B,EAAgB,QAAO,EACvB+B,GACF,CAEA,SAASA,GAAc,CACjBxB,EAAO,GAAKE,GAAaF,GAAQ,KAAK,KAAKE,EAAY,EAAE,EAC3DH,EAAQ,MAAM,WAAa,WAE3BA,EAAQ,MAAM,WAAa,SAC3BO,EAAU,8BAA8B,EAE5C,CAGAV,EAAY,iBAAiB,QAAS6B,CAAU,EAEhD,SAASA,GAAa,CACpB,MAAMC,EAAe,SAAS,cAAc,WAAW,EACnDA,GACFA,EAAa,OAAM,CAEvB,CAEA/B,EAAK,iBAAiB,SAAU,IAAM,CACpC8B,IACA7B,EAAY,MAAQA,EAAY,MAAM,KAAI,CAC5C,CAAC"}