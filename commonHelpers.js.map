{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport Axios from 'axios';\n\nconst form = document.querySelector('.form');\nconst searchInput = document.querySelector('.input-name');\nconst loader = document.querySelector('.loader');\nconst gallery = document.querySelector('.gallery');\nconst loadBtn = document.querySelector('.load-btn');\nlet currentSearchQuery = '';\nlet totalResult = 0;\nlet totalHits = 0;\nlet page = 1;\n\nconst axios = Axios.create({\n  baseURL: 'https://pixabay.com',\n  params: {\n    key: '42310325-d8e2b88bd4f4d7db9639050a5',\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: 15,\n    page: 1,\n  },\n});\n\nlet galleryLightbox = new SimpleLightbox('.image-link', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nform.addEventListener('submit', getPhoto);\nloadBtn.addEventListener('click', onLoadMoreClick);\n\nasync function getPhoto(event) {\n  event.preventDefault();\n\n  const searchQuery = searchInput.value.trim();\n\n  if (searchQuery === '') {\n    iziToast.show({\n      title: 'Error',\n      message: 'Please enter a search query',\n    });\n    return;\n  }\n\n  gallery.innerHTML = '';\n  page = 1;\n  totalResult = 0;\n  currentSearchQuery = searchQuery; // Зберігаємо поточний пошуковий запит\n  hideLoadBtn();\n  loader.classList.add('visible');\n\n  try {\n    const response = await axios.get('/api/', {\n      params: { q: searchQuery },\n    });\n    const data = response.data;\n    totalHits = data.totalHits;\n    totalResult = renderPhotos(data.hits, totalHits, totalResult);\n  } catch (error) {\n    console.log('Error fetching data:', error);\n    iziToast.show({\n      title: 'Error',\n      message: 'Oops, something went wrong',\n    });\n  } finally {\n    loader.classList.remove('visible');\n  }\n}\n\nfunction renderPhotos(photos) {\n  if (photos.length === 0) {\n    iziToast.show({\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n      backgroundColor: 'red',\n      messageColor: 'white',\n      messageSize: '25',\n    });\n    return;\n  }\n\n  photos.forEach(photo => {\n    const {\n      webformatURL,\n      largeImageURL,\n      tags,\n      likes,\n      views,\n      comments,\n      downloads,\n    } = photo;\n    const photoElement = makeMarkup(\n      webformatURL,\n      largeImageURL,\n      tags,\n      likes,\n      views,\n      comments,\n      downloads\n    );\n    gallery.insertAdjacentHTML('beforeend', photoElement);\n  });\n\n  totalResult += photos.length;\n\n  galleryLightbox.refresh();\n\n  isLoadMore(totalResult, totalHits);\n  return totalResult;\n}\n\nfunction makeMarkup(\n  webformatURL,\n  largeImageURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads\n) {\n  return `<li class=\"photo\">\n  <div class=\"photo-card\">\n    <a class=\"image-link\" data-lightbox=\"image\" href=\"${largeImageURL}\">\n    <img class=\"gallery-image\" data-source=\"${largeImageURL}\"  src=\"${webformatURL}\" alt=\"${tags}\"></img>\n    </a>\n    </div>\n      <div class=\"description\">\n        <p class=\"description-item\"> Likes ${likes}</p>\n        <p class=\"description-item\"> Views ${views}</p>\n        <p class=\"description-item\"> Comments ${comments}</p>\n        <p class=\"description-item\"> Downloads ${downloads}</p>\n    </div>\n  </li>`;\n}\n\nasync function onLoadMoreClick() {\n  const searchQuery = searchInput.value.trim();\n\n  if (totalResult >= totalHits) {\n    if (currentSearchQuery === '') {\n      iziToast.show({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        backgroundColor: '#125487',\n        messageColor: 'white',\n        messageSize: '25',\n      });\n    } else {\n      iziToast.show({\n        message: \"Cannot load more images. You've reached the limit.\",\n        backgroundColor: '#125487',\n        messageColor: 'white',\n        messageSize: '25',\n      });\n    }\n    return;\n  }\n\n  loader.classList.add('visible');\n\n  try {\n    const response = await axios.get('/api/', {\n      params: { q: searchQuery, page: (page += 1) },\n    });\n    const data = response.data;\n\n    totalHits = data.totalHits;\n    totalResult = renderPhotos(data.hits, totalHits, totalResult);\n    smoothScrollToNextGallery();\n  } catch (error) {\n    console.log('Error fetching data:', error);\n    iziToast.show({\n      title: 'Error',\n      message: 'Oops, something went wrong',\n    });\n  } finally {\n    loader.classList.remove('visible');\n  }\n}\n\nfunction isLoadMore(totalResult, totalHits) {\n  if (totalResult >= totalHits) {\n    hideLoadBtn();\n  } else {\n    showLoadBtn();\n  }\n}\n\nfunction smoothScrollToNextGallery() {\n  const galleryItemHeight = document\n    .querySelector('.photo')\n    .getBoundingClientRect().height;\n  window.scrollBy({ top: galleryItemHeight * 2, behavior: 'smooth' });\n}\n\nfunction showLoadBtn() {\n  loadBtn.style.visibility = 'visible';\n}\n\nfunction hideLoadBtn() {\n  loadBtn.style.visibility = 'hidden';\n}\n"],"names":["form","searchInput","loader","gallery","loadBtn","currentSearchQuery","totalResult","totalHits","page","axios","Axios","galleryLightbox","SimpleLightbox","getPhoto","onLoadMoreClick","event","searchQuery","iziToast","hideLoadBtn","data","renderPhotos","error","photos","photo","webformatURL","largeImageURL","tags","likes","views","comments","downloads","photoElement","makeMarkup","isLoadMore","smoothScrollToNextGallery","showLoadBtn","galleryItemHeight"],"mappings":"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"}